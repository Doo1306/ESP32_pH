<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ESP32pH.Views.LoginView"
             xmlns:view ="clr-namespace:ESP32pH.Views"
             xmlns:viewmodel="clr-namespace:ESP32pH.ViewModels"
             xmlns:convertor="clr-namespace:ESP32pH.Convertors"
             Shell.NavBarIsVisible="False"
             >
    <ContentPage.BindingContext>
        <viewmodel:LoginViewModel/>
    </ContentPage.BindingContext>


    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- Custom Styles -->
            <Style x:Key="CardStyle" TargetType="Border">
                <Setter Property="BackgroundColor" Value="#1A1A2E"/>
                <Setter Property="Stroke" Value="#2D2D44"/>
                <Setter Property="StrokeThickness" Value="1"/>
                <Setter Property="StrokeShape" Value="RoundRectangle 20"/>
                <Setter Property="Shadow">
                    <Setter.Value>
                        <Shadow Brush="Black" Opacity="0.3" Radius="15" Offset="0,5"/>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="InputFieldStyle" TargetType="Border">
                <Setter Property="BackgroundColor" Value="#16213E"/>
                <Setter Property="Stroke" Value="#2D2D44"/>
                <Setter Property="StrokeThickness" Value="1"/>
                <Setter Property="StrokeShape" Value="RoundRectangle 12"/>
                <Setter Property="Padding" Value="15,12"/>
            </Style>

            <Style x:Key="PrimaryButtonStyle" TargetType="Button">
                <Setter Property="BackgroundColor" Value="#667EEA"/>
                <Setter Property="TextColor" Value="White"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="CornerRadius" Value="25"/>
                <Setter Property="HeightRequest" Value="50"/>
                <Setter Property="Shadow">
                    <Setter.Value>
                        <Shadow Brush="#667EEA" Opacity="0.4" Radius="10" Offset="0,4"/>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="TitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="32"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor" Value="White"/>
                <Setter Property="HorizontalOptions" Value="Center"/>
            </Style>

            <Style x:Key="SubtitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="TextColor" Value="#A0A0B8"/>
                <Setter Property="HorizontalOptions" Value="Center"/>
            </Style>

            <Style x:Key="InputTextStyle" TargetType="Entry">
                <Setter Property="BackgroundColor" Value="Transparent"/>
                <Setter Property="TextColor" Value="White"/>
                <Setter Property="PlaceholderColor" Value="#7A7A9A"/>
                <Setter Property="FontSize" Value="16"/>
            </Style>

            <Style x:Key="PasswordToggleButtonStyle" TargetType="Button">
                <Setter Property="BackgroundColor" Value="Transparent"/>
                <Setter Property="TextColor" Value="#7A7A9A"/>
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="WidthRequest" Value="40"/>
                <Setter Property="HeightRequest" Value="40"/>
                <Setter Property="CornerRadius" Value="20"/>
                <Setter Property="BorderWidth" Value="0"/>
            </Style>
            <convertor:StringToColorConverter x:Key="converstring4Color"/>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid Padding="0" RowSpacing="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Background Gradient Overlay -->
        <Ellipse Fill="#764BA2" 
                 Opacity="0.15" 
                 WidthRequest="600" 
                 HeightRequest="600" 
                 HorizontalOptions="Start" 
                 VerticalOptions="Start" 
                 Margin="-300,-300,0,0"/>

        <Ellipse Fill="#667EEA" 
                 Opacity="0.15" 
                 WidthRequest="500" 
                 HeightRequest="500" 
                 HorizontalOptions="End" 
                 VerticalOptions="End" 
                 Margin="0,0,-250,-250"/>

        <!-- Additional decorative elements -->
        <Ellipse Fill="#FF6B6B" 
                 Opacity="0.08" 
                 WidthRequest="350" 
                 HeightRequest="350" 
                 HorizontalOptions="Center" 
                 VerticalOptions="Start" 
                 Margin="0,-175,0,0"/>

        <!-- Main Content Container -->
        <ScrollView Padding="20" VerticalOptions="FillAndExpand">

            <StackLayout VerticalOptions="CenterAndExpand" Spacing="0">

                <!-- Login Card -->
                <Border Style="{StaticResource CardStyle}"
                        Padding="40,50"
                        MaximumWidthRequest="450"
                        HorizontalOptions="Center"
                        VerticalOptions="Center">

                    <StackLayout Spacing="25">

                        <!-- Logo/Avatar Section -->
                        <StackLayout Spacing="15" HorizontalOptions="Center">
                            <Border BackgroundColor="#667EEA"
                            StrokeShape="RoundRectangle 25"
                            WidthRequest="80"
                            HeightRequest="80"
                            HorizontalOptions="Center">
                                <Border.Shadow>
                                    <Shadow Brush="#667EEA" Opacity="0.3" Radius="10" Offset="0,4"/>
                                </Border.Shadow>
                                <Label Text="🔐"
                               FontSize="36"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                            </Border>

                            <Label Text="ESP32 pH " Style="{StaticResource TitleStyle}"/>
                            <Label Text="Sign in to your account" Style="{StaticResource SubtitleStyle}"/>
                        </StackLayout>

                        <!-- Form Fields -->
                        <StackLayout Spacing="20">

                            <!-- Username Field -->
                            <StackLayout Spacing="8">
                                <Label Text="Username" 
                               TextColor="#A0A0B8" 
                               FontSize="14" 
                               Margin="5,0"/>
                                <Border Style="{StaticResource InputFieldStyle}">
                                    <Grid ColumnSpacing="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>


                                        <Image Grid.Column="0"
                                           Source="userlogin.svg"
                                           WidthRequest="20"
                                           HeightRequest="20"
                                           VerticalOptions="Center"
                                           HorizontalOptions="Center" />

                                        <Entry Grid.Column="1"
                                       Placeholder="Enter your username"
                                       Style="{StaticResource InputTextStyle}"
                                       Text="{Binding UserName}"/>
                                    </Grid>
                                </Border>
                            </StackLayout>

                            <!-- Password Field -->
                            <StackLayout Spacing="8">
                                <Label Text="Password"
                                   TextColor="#A0A0B8"
                                   FontSize="14"
                                   Margin="5,0" />

                                <Border Style="{StaticResource InputFieldStyle}">
                                    <Grid ColumnSpacing="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <!-- Icon khóa -->

                                        <Image Grid.Column="0"
                                           Source="authent.svg"
                                           WidthRequest="20"
                                           HeightRequest="20"
                                           VerticalOptions="Center"
                                           HorizontalOptions="Center" />

                                        <!-- Entry nhập mật khẩu -->
                                        <Entry Grid.Column="1"
                                           x:Name="PasswordEntry"
                                           Placeholder="Enter your password"
                                           IsPassword="{Binding IsPasswordHidden}"
                                           Style="{StaticResource InputTextStyle}"
                                           Text="{Binding Password}" />


                                        <!-- Nút ẩn/hiện -->
                                        <ImageButton Grid.Column="2"
                                            Source="{Binding PasswordToggleIcon}"                                               
                                            BackgroundColor="Transparent"                                           
                                            BorderWidth="0"
                                            WidthRequest="10"
                                            HeightRequest="10"
                                            CornerRadius="10"
                                            Command="{Binding TogglePasswordVisibilityCommand}">
                                            <ImageButton.Shadow>
                                                <Shadow Opacity="0.3"
                                                    Radius="8"
                                                    Offset="0,2" />
                                            </ImageButton.Shadow>
                                        </ImageButton>
                                    </Grid>
                                </Border>
                            </StackLayout>
                        </StackLayout>

                        <StackLayout Grid.Column="0" 
                                 Orientation="Horizontal" 
                                  
                                 Spacing="2">
                            <CheckBox 
                                 Color="#667EEA" 
                                 IsChecked="{Binding RememberMe}" 
                                 VerticalOptions="Center"/>
                            <Label Text="Remember me" 
                               TextColor="#A0A0B8" 
                               FontSize="14" 
                               VerticalOptions="Center"/>
                        </StackLayout>

                        <!-- Login Button -->
                        <Button Text="Sign In"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Command="{Binding LoginCommand}"
                        Margin="0,20,0,0">
                            <Button.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <GradientStop Color="#667EEA" Offset="0"/>
                                    <GradientStop Color="#764BA2" Offset="1"/>
                                </LinearGradientBrush>
                            </Button.Background>
                        </Button>

                    </StackLayout>
                </Border>

            </StackLayout>
        </ScrollView>

    </Grid>
</ContentPage>